<h2>Edit Patient</h2>
<form *ngIf="!isUpdate || pharmacy; else loading" class="form-signin" #loginForm="ngForm" (ngSubmit)="registUser(loginForm)">
    <div class="registrationbox col-sm-8">
        <div *ngIf="error" class="alert alert-danger">{{ error }}</div>
        <div *ngIf="!uniqueName" class="alert alert-danger">User Name is invalid or already in use.</div>
        <h4 for="userName">Username</h4>
        <input type="text" id="userName" name="userName" ngModel = {{pharmacy?.userName}} class="form-control" placeholder="User Name" required autofocus>
        <br/>
        <h4 for="nativeName" >Name</h4>
        <input type="text" id="nativeName" name="nativeName" ngModel = {{pharmacy?.name}} class="form-control" placeholder="Native Name" required>
        <br/>
        <div *ngIf="passwordIsEnabled then passwordEnabled; else passwordDisabled"></div>
        <ng-template #passwordEnabled>
            <div *ngIf="passwordToShort(password.value)" class="alert alert-danger">Passwords must be at least 8 character</div>
            <h4 for="password" >Password</h4>
            <input #password type="password" id="password" name="password" ngModel class="form-control" placeholder="Password" required>
            <br/>
            <div *ngIf="passwordNotMatch(password.value, repassword.value)" class="alert alert-danger">Passwords are not matching</div>
            <h4 for="repassword" >Password Again</h4>
            <input #repassword type="password" id="repassword" name="repassword" ngModel class="form-control" placeholder="Password Again" required>     
            <div *ngIf="isUpdate">
                <br/>
                <a class="btn btn-lg btn-info text-white btn-block" (click)="invertPasswordVisibility()">Disable password reset</a>
            </div>
        </ng-template>
        <ng-template #passwordDisabled>
            <a class="btn btn-lg btn-info text-white btn-block" (click)="invertPasswordVisibility()">Enable password reset</a>
        </ng-template>
        <br/>
        <div *ngIf="!emailIsValid(email.value)" class="alert alert-danger">Email should look like: account@company.domain</div>
        <h4 for="email" >Email Address</h4>
        <input #email type="email" id="email" name="email" ngModel = {{pharmacy?.email}} class="form-control" placeholder="Email Address" required>
        <br/>
        <h4 for="country" >Country</h4>
        <input type="text" id="country" name="country" ngModel = {{pharmacy?.country}} class="form-control" placeholder="Country" required>
        <br/>
        <h4 for="city" >City</h4>
        <input type="text" id="city" name="city" ngModel = {{pharmacy?.city}} class="form-control" placeholder="City" required>
        <br/>
        <h4 for="postalCode" >Postal Code</h4>
        <input type="text" id="postalCode" name="postalCode" ngModel = {{pharmacy?.postalCode}} class="form-control" placeholder="Postal Code" required>
        <br/>
        <h4 for="address" >Address</h4>
        <input type="text" id="address" name="address" ngModel = {{pharmacy?.address}} class="form-control" placeholder="Address" required>
        <br/>
        <div>
            <a *ngIf="!supportDelivery; else noDelivery" class="btn btn-lg btn-success text-white btn-block left" (click)="invertDeliverySupport()">Support Delivery <fa-icon [icon]="['fas', 'truck']"></fa-icon></a>
            <ng-template #noDelivery>
                <a class="btn btn-lg btn-danger text-white btn-block left" (click)="invertDeliverySupport()">Unsupport Delivery <fa-icon [icon]="['fas', 'truck']"></fa-icon></a>
            </ng-template>
            <a *ngIf="!supportPreOrder; else noPreOrder" class="btn btn-lg btn-success text-white btn-block right" (click)="invertPreOrderSupport()">Support Pre-order <fa-icon [icon]="['far', 'credit-card']"></fa-icon></a>
            <ng-template #noPreOrder>
                <a class="btn btn-lg btn-danger text-white btn-block right" (click)="invertPreOrderSupport()">Unsupport Pre-order <fa-icon [icon]="['far', 'credit-card']"></fa-icon></a>
            </ng-template>
        </div>
        <br/>
        <br/>
        <br/>
        <a class="btn btn-lg btn-danger text-white btn-block col-sm-3 cancel" (click)="location.back()">Cancel <fa-icon [icon]="['fas', 'ban']"></fa-icon></a>
        <button class="btn btn-lg btn-success btn-block col-sm-3 save" type="submit">Save <fa-icon [icon]="['far', 'save']"></fa-icon></button>
    </div>
</form>
<ng-template #loading>
    <div class="d-flex justify-content-center">
        <div class="spinner-border text-primary" style="width: 5rem; height: 5rem;" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
</ng-template>